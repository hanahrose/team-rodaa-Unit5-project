namespace SpriteKind {
    export const gate = SpriteKind.create()
    export const Brick = SpriteKind.create()
}
controller.B.onEvent(ControllerButtonEvent.Pressed, function () {
    Hands = sprites.createProjectileFromSprite(img`
        . . . . . . . . . . . . . . . . 
        . . . . . . . . . . . . . . . . 
        . . . . . . . . . . . . . . . . 
        . . . . . . d d d d . . . . . . 
        . . d d 3 d d 3 d d d d d d d d 
        . . d d 3 d d 3 d d d 3 d d d d 
        . d d d 3 d d 3 d d d 3 d d d d 
        d d d d 3 d d 3 d d d 3 d d d d 
        d d d d 3 d d 3 d d d 3 d d d d 
        d d d d d d d d d d d d 3 3 3 3 
        d d d d d d d d d d d 3 d d d d 
        d d d d d d d d d d d d d d d d 
        d d d d d d d d d d d d d d d d 
        d d d d d d d d d d d d d d d . 
        d d d d d d d d d d d d d d . . 
        . d d d d d d d d d d d d d . . 
        `, Hannah, randint(100, -100), randint(100, -100))
})
function talkToBossDerek () {
    story.spriteSayText(bossDerek, "HEY!", 2)
    story.spriteSayText(bossDerek, "GINGER!", 2)
    story.spriteSayText(Hannah, ":(", 10)
    story.spriteSayText(bossDerek, "YOURE GONNA DIE", 2)
    story.spriteSayText(bossDerek, "Cringe", 2)
    story.cancelCurrentCutscene()
}
controller.A.onEvent(ControllerButtonEvent.Pressed, function () {
    if (Hannah.overlapsWith(Derek)) {
        talkToDerek()
    }
})
function fightDerek () {
    scene.cameraShake(4, 1000)
    pause(1000)
    tiles.setCurrentTilemap(tilemap`level3`)
    game.splash("BOSS FIGHT STARTING")
    tiles.placeOnTile(Derek, tiles.getTileLocation(9, 7))
    tiles.placeOnTile(Hannah, tiles.getTileLocation(9, 6))
    pause(1000)
    Derek.destroy(effects.confetti, 1000)
    pause(1000)
    info.setLife(5)
    bossDerek = sprites.create(img`
        . . . . . . . . . . . . . . . . 
        . . . . . . . . . . . . . . . . 
        . . . f . f . . 3 . . f . f . . 
        . . . . 9 . . . 3 . . . 9 . . . 
        . . . . . . . . . . . . . . . . 
        . . . 9 9 9 9 9 9 9 9 9 9 9 . . 
        . . 9 9 9 9 9 9 9 9 9 9 9 9 9 . 
        . . 2 9 9 3 3 3 3 3 3 3 9 9 2 . 
        . . . 2 9 9 3 3 3 9 9 9 9 2 . . 
        . . . . 2 2 9 3 9 9 9 9 2 2 . . 
        . . . . . . 2 9 9 9 9 2 . . . . 
        . . . . . . . . . . . . . . . . 
        . . . . . . . . . . . . . . . . 
        . . . . . . . . . . . . . . . . 
        . . . . . . . . . . . . . . . . 
        . . . . . . . . . . . . . . . . 
        `, SpriteKind.Enemy)
    tiles.placeOnTile(bossDerek, tiles.getTileLocation(9, 2))
}
sprites.onOverlap(SpriteKind.Enemy, SpriteKind.gate, function (sprite, otherSprite) {
    story.startCutscene(function () {
        scene.centerCameraAt(50, 50)
        tiles.placeOnTile(bossDerek, tiles.getTileLocation(4, 4))
        tiles.placeOnTile(Hannah, tiles.getTileLocation(4, 6))
    })
    bossDerek.destroy(effects.spray, 500)
})
function talkToDerek () {
    story.startCutscene(function () {
        story.spriteSayText(Hannah, "Hey Derek", 10)
        story.spriteSayText(Derek, "Cringe Midget", 14)
        scene.cameraFollowSprite(Hannah)
        fightDerek()
    })
}
sprites.onOverlap(SpriteKind.Brick, SpriteKind.Player, function (sprite, otherSprite) {
    info.changeLifeBy(-1)
})
sprites.onOverlap(SpriteKind.Projectile, SpriteKind.Enemy, function (sprite, otherSprite) {
    bossFightDerek()
    if (gate1) {
        story.spriteSayText(bossDerek, "Ow", 2)
    }
})
sprites.onOverlap(SpriteKind.Player, SpriteKind.Enemy, function (sprite, otherSprite) {
    talkToBossDerek()
})
function bossFightDerek () {
    gate1 = sprites.create(img`
        1 1 1 1 1 1 1 1 1 1 1 1 . . . . 
        1 1 1 1 1 1 1 1 1 1 1 1 . . . . 
        1 1 1 1 1 1 1 1 1 1 1 1 . . . . 
        1 1 1 1 1 1 1 1 1 1 1 1 . . . . 
        1 1 1 1 1 1 1 1 1 1 1 1 . . . . 
        1 1 1 1 1 1 1 1 1 1 1 1 . . . . 
        1 1 1 1 1 1 1 1 1 1 1 1 . . . . 
        1 1 1 1 1 1 1 1 1 1 1 1 . . . . 
        1 1 1 1 1 1 1 1 1 1 1 1 . . . . 
        . . . . . . . . . . . . . . . . 
        . . . . . . . . . . . . . . . . 
        . . . . . . . . . . . . . . . . 
        . . . . . . . . . . . . . . . . 
        . . . . . . . . . . . . . . . . 
        . . . . . . . . . . . . . . . . 
        . . . . . . . . . . . . . . . . 
        `, SpriteKind.gate)
    tiles.placeOnTile(gate1, tiles.getTileLocation(1, 1))
    Brick = sprites.create(img`
        . . . . . . . . . . . . . . . . 
        . . . . . . . 4 2 4 . . . . . . 
        . . . . . . 4 4 2 4 4 4 . . . . 
        . . . . . 4 4 2 2 2 2 4 4 4 . . 
        . . . 4 4 2 2 2 2 2 2 2 2 4 4 . 
        . . 4 4 2 2 2 2 2 2 2 2 2 2 2 4 
        . 4 2 2 2 2 2 2 2 2 2 2 2 2 2 4 
        4 4 2 2 2 2 2 2 2 2 2 2 2 4 4 2 
        4 2 2 2 2 2 2 2 2 2 2 2 4 4 2 2 
        2 2 2 2 2 2 2 2 2 2 2 4 4 2 2 4 
        4 2 2 2 2 2 2 2 2 4 4 4 2 4 4 . 
        4 2 2 2 2 2 2 4 4 2 2 2 4 4 . . 
        . 4 2 2 2 4 4 4 2 2 4 4 4 . . . 
        . 4 2 2 4 4 2 2 2 4 4 . . . . . 
        . . 4 4 2 2 2 4 4 . . . . . . . 
        . . 4 4 4 2 2 4 . . . . . . . . 
        `, SpriteKind.Brick)
    info.startCountdown(100)
    pause(200)
}
let Brick: Sprite = null
let gate1: Sprite = null
let bossDerek: Sprite = null
let Hands: Sprite = null
let Derek: Sprite = null
let Hannah: Sprite = null
tiles.setCurrentTilemap(tilemap`level1`)
Hannah = sprites.create(img`
    .........................
    .........................
    .....2222222222222.......
    ...22222222222222222.....
    ...222222222222222222....
    ...2222ddddddddd222222...
    ...222dddddddddddd2222...
    ...222d77ddddddddd22222..
    ..2222df7dd3ddd77dd2222..
    ..2222dddd33dddf7dd2222..
    22223333333ddddddddd2222.
    22233ddddddddddddddd2222.
    2223dddddddddddddddd22222
    222333ddddd33dddddddd2222
    222223333333ddddddddd2222
    22222dddddddddddddddd2222
    222222dd3ddddddd3dddd2222
    2222222dd33333333ddd22222
    222222222ddddddddddd22222
    222222222ddddddddd2222222
    22222222dddddddddd2222222
    2222222dddddddddddd222222
    2222227777ddddddddd722222
    2222277777777777777772222
    2222777777777777777777222
    `, SpriteKind.Player)
Derek = sprites.create(img`
    ................................................................................
    ................................................................................
    ................................................................................
    .........................eeeeeeeeeee............................................
    ......................eeeeeeeeeeeeeeeeeee.......................................
    ....................eeeeeeeeeeeeeeeeeeeeeeeee...................................
    ...................eeeeeeeeeeeeeeeeeeeeeeeeeeee.................................
    ...................eeeeeeeeeeeeeeeeeeeeeeeeeeeeee...............................
    ..................eeeeeeeeeeedddeeeeeeeeeeeeeeeeeeee............................
    .................eeeeeeeeedddddddddddddeeeeeeeeeeeeeeee.........................
    ................eeeeeeeeeddddddddddddddddeeeeeeeeeeeeeeee.......................
    ................eeeeeeeedddddddddddddddddddeeeeeeeeeeeeeee......................
    ..............eeeeeeeeeddddddddddddddddddddddeeeeeeeeeeeeeee....................
    ..............eeeeeeeeeeeeeeeeedddddddddddddddddeeeeeeeeeeeee...................
    .............eeeeeeeeeeeeeeeeeeeeddddddddddddddddddeeeeeeeeee...................
    .............eeeeeeeeeeeeeeeeeeeeddddddddddddddddddddeeeeeeee...................
    .............eeeeeeedddfffffffeeeeeedddddddddddddeeeeeeeeeeee...................
    .............eeeeeeefffffffffffffeeeeddddddddddeeeeeeeddeeeeee..................
    .............eeeeeeffffffffffffffeeeeddddeeeeeeeeeeeeeddeeeeee..................
    .............eeeeefffffffdddddfffeeeedddeeeeeeeeeeeeeeddeeeeee..................
    .............eeeeefffffdddddddffffeeedddeeeeeeeeeefffdddeeeeee..................
    .............eeeeeffffddddddddffffddddddeeefffffffffffdddeeeee..................
    ..............eeeffffddddddddddffffdddddddffffffffffffdddeeeee..................
    ............eeeeeffffddddddddddffffddddddfffffffffffffdddeeeee..................
    ............eeeeeffffdddddddddddfffdddddffffffdddddfffdddeeeee..................
    ............eeeeefffdddddfffddddfffddddffffffddddddfffdddeeeee..................
    ............eeeeefffdddddfffddddfffddddffffddddddddfffddeeeeee..................
    ...........eeeeeeffffddddfffddddffffffffffddfffddddfffddfffffff.................
    ...........eeeeeeffffdddddddddddffffffffffddfffddddfffdffffffff.................
    .....eeeeeeeeeeeeeffffddddddddddffffffffffddfffdddfffffffffffff.................
    ....eeeeeeeeeeeeeefffffdddddddddfffddddfffddddddddfffffffffefff.................
    ....eeeeeeeeeeeeeeefffffffdddddffffddddfffddddddddffffffffeefff.................
    eeeeeeeeeeeeeeeeeeedffffffffddfffffddddffffddddddffffdeeeeeee...................
    eeeeeeeeeeeeeeeeeeeddfffffffffffffdddddfffffddddfffffdeeeeeeeee.................
    eeeeeeeeeeeeeeeeeeedddddffffffffffdddddfffffffffffffddeeeeeeeee.................
    eeeeeeeeeeeeeeeeeeedddddddffffff333dddddfffffffffffdddeeeeeeeeee................
    eeeeeeeeeeeeeeeeeeedddddddddddd3333ddddddfffffffffddddeeeeeeeeeeeeee............
    .eeeeeeeeeeeeeeedddddddddddddd33333dddddddddddddddddddeeeeeeeeeeeeee............
    ...eeeeeeeeeeeeedddddddddddddd3333ddddddddddddddddddddeeeeeeeeeeeeee............
    ....eeeeeeeeeeeeddddddddddddd33333ddddddddddddddddddddeeeeeeeeeeeeee............
    ................dddddddddddd33333dddddddddddddddddddddeeeeeeeeeeeeee............
    ................dddddddddddd33333dddddddddddddddddddddeeeeeeeeeeeeee............
    ................dddddddddddd3333ddd333ddddddddddddddddeeeeeeeeeeeeee............
    ................dddddddddddd333dddd333ddddddddddddddddeeeeeeeeeeeeee............
    ................dddddddddddd333333d333dddddddddddddddddddeeeeeeeeee.............
    ...............ddddddddddddd333333dddddddddddddddddddddddeeeeeeee...............
    .............dddd22222dddddd333333dddddddddddddddddddddddeeeeee.................
    ...........dddd22222222dddddddddddddddddddddddddddddddddd.......................
    ........dddddd2222222222ddddddddddddddddddddddddddddddddd.......................
    .....ddddddd2222222222222222222ddddddddddddddddddddddddd........................
    ....dddddddd222222ccc2222222222ddddddddddddddddddddddddd........................
    ...ddddddded222222cccc2222222222ddddddddddddddddddddddd.........................
    ..dddddededddd22222cccc222cc22222ddddddddddddddddddddd..........................
    ..ddddddeddddd22222cccccccccc22222dddddddddddddddddddd..........................
    ..dddeddddddddd222222cccccccc22222ddddddddddddddddddd...........................
    ..dddddddddedddd22222222cccc222222dddddddddddddddddd............................
    ..dddddddddddddd222222222222222ddddddddddddddddddddd............................
    ..dddeeddddddedddd2222222222222dddddddddddddddddddd.............................
    ..ddedddddeedddddddddd222222222ddddddddddddddddddd..............................
    ...ddddddddddddddddddddddddddddddddddddddddddddd777.............................
    ...dddddededddddddeddddddddddddddddddddddddddd77777.............................
    ...dddddddddddddddddddddddddddeddddddddddddd7777777.............................
    ...dddeddddddeddddddddeddddddddddeddddddddd77777777.............................
    ....ddddedddddddddddddddddeddddddddddddd777777777777............................
    .....dddddddedddddedddddeddddddddddddd777777777777777...........................
    ......dddddddddddddddddddddddddddd777777777777777777777.........................
    ........dddddddeddddddddddddddd77777777777777777777777777.......................
    ..........dddedddddddddddd77777777777777777777777777777777777777777.............
    ..............7777777777777777777777777777777777777777777777777777777777........
    .............7777777777777777777777777777777777777777777777777777777777777......
    ............777777777777777777777777777777777777777777777777777777777777777.....
    ...........77777777777777777777777777777777777777777777777777777777777777777....
    .........77777777777777777777777777777777777777777777777777777777777777777777...
    ........777777777777777777777777777777777777777777777777777777777777777777777...
    .......7777777777777777777777777777777777777777777777777777777777777777777777...
    .......7777777777777777777777777777777777777777777777777777777777777777777777...
    .......7777777777777777777777777777777777777777777777777777777777777777777777...
    .......7777777777777777777777777777777777777777777777777777777777777777777777...
    .......7777777777777777777777777777777777777777777777777777777777777777777777...
    .......7777777777777777777777777777777777777777777777777777777777777777777777...
    `, SpriteKind.Player)
tiles.placeOnTile(Derek, tiles.getTileLocation(3, 13))
controller.moveSprite(Hannah)
scene.cameraFollowSprite(Hannah)
game.onUpdateInterval(1000, function () {
    if (gate1) {
        tiles.placeOnTile(Brick, tiles.getTileLocation(4, 5))
        Brick.setVelocity(50, 50)
    }
})
